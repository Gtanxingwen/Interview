<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ES6proxy 与 defineProperty 对比</title>
</head>
<body>
<script>
  let obj = {}
  let value = 1
  Object.defineProperty(obj, 'key', {
    configurable: true,
    enumerable: true,
    get() {
      console.log('get')
      return value
    },
    set(newVal) {
      console.log('set')
      value = newVal
    }
  })
  console.log('value 改变前')
  console.log(obj.key)
  obj.key = 2
  console.log('value 改变后')
  console.log(obj.key)
</script>
<script>
  const onWatch = (obj, setBind, getLogger) => {
    let handler = {
      get(target, property, receiver) {
        getLogger(target, property)
        return Reflect.get(target, property, receiver);
      },
      set(target, property, value, receiver) {
        setBind(value);
        return Reflect.set(target, property, value);
      }
    };
    return new Proxy(obj, handler)
  }
  let obj = {a: 1}
  let value
  let p = onWatch(obj, (v) => {
    value = v
  }, (target, property) => {
    console.log(`Get '${property}' = ${target[property]}`);
  })
  p.a = 2 // bind `value` to `2`
  p.a // -> Get 'a' = 2
</script>
</body>
</html>